{
    "type": [
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        2,
        0,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        0,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        0,
        0,
        1,
        2,
        0,
        0,
        1,
        0,
        1,
        0,
        1,
        2
    ],
    "data": [
        "\nR version 4.2.3 (2023-03-15) -- \"Shortstop Beagle\"\nCopyright (C) 2023 The R Foundation for Statistical Computing\nPlatform: x86_64-apple-darwin17.0 (64-bit)\n\nR is free software and comes with ABSOLUTELY NO WARRANTY.\nYou are welcome to redistribute it under certain conditions.\nType 'license()' or 'licence()' for distribution details.\n\n  Natural language support but running in an English locale\n\nR is a collaborative project with many contributors.\nType 'contributors()' for more information and\n'citation()' on",
        " how to cite R or R packages in publications.\n\nType 'demo()' for some demos, 'help()' for on-line help, or\n'help.start()' for an HTML browser interface to help.\nType 'q()' to quit R.\n\n[Workspace loaded from ~/Downloads/UI_R/.RData]\n\n",
        "> ",
        "install.packages(\"pdftools\")",
        "\n  There is a binary version available but the source version is later:\n         binary source needs_compilation\npdftools  3.4.0  3.5.0              TRUE\n\n",
        "Do you want to install from sources the package which needs compilation? (Yes/no/cancel) ",
        "install.packages(\"readr\")",
        "Error in install.packages : Unrecognized response â€œinstall.packages(\"readr\")â€\n",
        "> ",
        "install.packages(\"rstudioapi\")",
        "\n  There is a binary version available but the source version is later:\n           binary source needs_compilation\nrstudioapi 0.15.0 0.17.1             FALSE\n\n",
        "installing the source package â€˜rstudioapiâ€™\n\ntrying URL 'https://cran.rstudio.com/src/contrib/rstudioapi_0.17.1.tar.gz'\nContent type 'application/x-gzip' length 118455 bytes (115 KB)\n==================================================\ndownloaded 115 KB\n\n* installing *source* package â€˜rstudioapiâ€™ ...\n** package â€˜rstudioapiâ€™ successfully unpacked and MD5 sums checked\n** using staged installation\n** R\n** inst\n** byte-compile and prepare package for lazy loading\n** help\n*** installing help indices\n***",
        " copying figures\n** building package indices\n** installing vignettes\n** testing if installed package can be loaded from temporary location\n** testing if installed package can be loaded from final location\n** testing if installed package keeps a record of temporary installation path\n* DONE (rstudioapi)\n\nThe downloaded source packages are in\n\tâ€˜/private/var/folders/wx/yh26m6r95dsfw822mlv9060r0000gn/T/RtmpqSMNxW/downloaded_packagesâ€™\n",
        "> ",
        "library(pdftools)",
        "Using poppler version 22.02.0\n",
        "> ",
        "library(readr)",
        "> ",
        "library(rstudioapi)",
        "> ",
        "# === è®“ä½¿ç”¨è€…é¸æª”æ¡ˆ ===",
        "> ",
        "pdf_file <- selectFile(caption = \"è«‹é¸æ“‡ä½ çš„PDFæª”æ¡ˆ\", ",
        "+ ",
        "                       filter = \"PDF Files (*.pdf)\", ",
        "+ ",
        "                       path = getwd())  # é–‹åœ¨ç›®å‰å·¥ä½œç›®éŒ„",
        "> ",
        "> ",
        "if (is.null(pdf_file)) {",
        "+ ",
        "  stop(\"æ²’æœ‰é¸æ“‡ä»»ä½•æª”æ¡ˆï¼Œç¨‹å¼çµæŸï¼\")",
        "+ ",
        "}",
        "> ",
        "> ",
        "# è‡ªå‹•å‘½åCSVæª”ï¼ˆè·ŸPDFæª”åä¸€æ¨£ï¼Œåªæ˜¯å‰¯æª”åæ”¹æˆcsvï¼‰",
        "> ",
        "csv_file <- sub(\"\\\\.pdf$\", \".csv\", basename(pdf_file))",
        "> ",
        "> ",
        "# === é–‹å§‹è™•ç† ===",
        "> ",
        "text <- pdf_text(pdf_file)",
        "> ",
        "lines <- strsplit(text[1], \"\\n\")[[1]]",
        "> ",
        "> ",
        "start_row <- grep(\"ç¯€æ¬¡\", lines) + 1",
        "> ",
        "lines <- lines[start_row:length(lines)]",
        "> ",
        "lines <- lines[lines != \"\"]",
        "> ",
        "> ",
        "data_list <- list()",
        "> ",
        "> ",
        "for (line in lines) {",
        "+ ",
        "  fields <- strsplit(gsub(\"\\\\s+\", \",\", line), \",\")[[1]]",
        "+ ",
        "  if (length(fields) >= 8) {",
        "+ ",
        "    data_list <- append(data_list, list(fields[1:8]))",
        "+ ",
        "  }",
        "+ ",
        "}",
        "> ",
        "> ",
        "df <- as.data.frame(do.call(rbind, data_list), stringsAsFactors = FALSE)",
        "> ",
        "> ",
        "colnames(df) <- c(\"ç¯€æ¬¡(æ™‚é–“)\", \"æ˜ŸæœŸä¸€\", \"æ˜ŸæœŸäºŒ\", \"æ˜ŸæœŸä¸‰\", \"æ˜ŸæœŸå››\", \"æ˜ŸæœŸäº”\", \"æ˜ŸæœŸå…­\", \"æ˜ŸæœŸæ—¥\")",
        "Error in names(x) <- value : \n  'names' attribute [8] must be the same length as the vector [0]\n",
        "> ",
        "library(pdftools)",
        "> ",
        "library(readr)",
        "> ",
        "library(rstudioapi)",
        "> ",
        "> ",
        "# === 1. è®“ä½¿ç”¨è€…é¸æ“‡PDFæª”æ¡ˆ ===",
        "> ",
        "pdf_file <- selectFile(caption = \"è«‹é¸æ“‡ä½ çš„PDFæª”æ¡ˆ\", ",
        "+ ",
        "                       filter = \"PDF Files (*.pdf)\", ",
        "+ ",
        "                       path = getwd())  # é è¨­è·¯å¾‘ï¼šç•¶å‰å·¥ä½œç›®éŒ„",
        "> ",
        "> ",
        "if (is.null(pdf_file)) {",
        "+ ",
        "  stop(\"æ²’æœ‰é¸æª”æ¡ˆï¼ŒçµæŸï¼\")",
        "+ ",
        "}",
        "> ",
        "> ",
        "# è‡ªå‹•å‘½åCSVï¼ˆè·ŸPDFåŒåï¼‰",
        "> ",
        "csv_file <- sub(\"\\\\.pdf$\", \".csv\", basename(pdf_file))",
        "> ",
        "> ",
        "# === 2. è®€å–PDFæ–‡å­— ===",
        "> ",
        "text <- pdf_text(pdf_file)",
        "> ",
        "> ",
        "# åªè®€ç¬¬1é çš„æ–‡å­—",
        "> ",
        "lines <- strsplit(text[1], \"\\n\")[[1]]",
        "> ",
        "> ",
        "# ç§»é™¤å‰å¾Œç©ºç™½",
        "> ",
        "lines <- trimws(lines)",
        "> ",
        "> ",
        "# éæ¿¾æ‰å®Œå…¨ç©ºçš„è¡Œ",
        "> ",
        "lines <- lines[lines != \"\"]",
        "> ",
        "> ",
        "# é¡¯ç¤ºä¸€æ¬¡å…§å®¹ï¼ˆdebugç”¨ï¼‰",
        "> ",
        "# print(lines)",
        "> ",
        "> ",
        "# === 3. è‡ªå‹•æ‰¾å‡ºèª²è¡¨ç¯„åœ ===",
        "> ",
        "> ",
        "# æ‰¾åˆ°åŒ…å«ã€Œç¯€æ¬¡ã€é‚£ä¸€è¡Œ",
        "> ",
        "start_row <- grep(\"ç¯€æ¬¡\", lines)",
        "> ",
        "> ",
        "if (length(start_row) == 0) {",
        "+ ",
        "  stop(\"æ‰¾ä¸åˆ°ã€ç¯€æ¬¡ã€é€™å€‹å­—ï¼Œè«‹ç¢ºèªPDFå…§å®¹ï¼\")",
        "+ ",
        "}",
        "> ",
        "> ",
        "# å¾ã€Œç¯€æ¬¡ã€ä¸‹ä¸€è¡Œé–‹å§‹è®€å–",
        "> ",
        "lines <- lines[(start_row + 1):length(lines)]",
        "> ",
        "> ",
        "# å†æ¬¡ç¢ºèªæ²’æœ‰ç©ºè¡Œ",
        "> ",
        "lines <- lines[lines != \"\"]",
        "> ",
        "> ",
        "# === 4. è™•ç†æ¯ä¸€è¡Œï¼Œè½‰æˆé€—è™Ÿåˆ†éš” ===",
        "> ",
        "data_list <- list()",
        "> ",
        "> ",
        "for (line in lines) {",
        "+ ",
        "  # æŠŠå¤šå€‹ç©ºç™½æ›æˆå–®å€‹é€—è™Ÿ",
        "+ ",
        "  fields <- strsplit(gsub(\"\\\\s+\", \",\", line), \",\")[[1]]",
        "+ ",
        "  ",
        "+ ",
        "  # è‡ªå‹•è£œé½Šæ¬„ä½ï¼ˆå¦‚æœä¸å¤ 8å€‹å°±å¡«ç©ºç™½ï¼‰",
        "+ ",
        "  if (length(fields) < 8) {",
        "+ ",
        "    fields <- c(fields, rep(\"\", 8 - length(fields)))",
        "+ ",
        "  }",
        "+ ",
        "  ",
        "+ ",
        "  data_list <- append(data_list, list(fields[1:8]))  # ä¿è­‰æ¯è¡Œéƒ½æ˜¯8æ¬„",
        "+ ",
        "}",
        "> ",
        "> ",
        "# å¦‚æœçœŸçš„ä¸€ç­†è³‡æ–™éƒ½æ²’æœ‰",
        "> ",
        "if (length(data_list) == 0) {",
        "+ ",
        "  stop(\"è®€å–å¤±æ•—ï¼Œæ²’æœ‰æ‰¾åˆ°ä»»ä½•èª²è¡¨è³‡æ–™ï¼\")",
        "+ ",
        "}",
        "> ",
        "> ",
        "# === 5. è½‰æˆdata.frame & è¨­æ¬„ä½åç¨± ===",
        "> ",
        "df <- as.data.frame(do.call(rbind, data_list), stringsAsFactors = FALSE)",
        "> ",
        "colnames(df) <- c(\"ç¯€æ¬¡(æ™‚é–“)\", \"æ˜ŸæœŸä¸€\", \"æ˜ŸæœŸäºŒ\", \"æ˜ŸæœŸä¸‰\", \"æ˜ŸæœŸå››\", \"æ˜ŸæœŸäº”\", \"æ˜ŸæœŸå…­\", \"æ˜ŸæœŸæ—¥\")",
        "> ",
        "> ",
        "# === 6. è¼¸å‡ºæˆCSVæª” ===",
        "> ",
        "write_csv(df, csv_file)",
        "\r\u001B[1mwrote\u001B[0m \u001B[32m204.00B\u001B[0m in \u001B[36m 0s\u001B[0m, \u001B[32m8.91MB/s\u001B[0m\r\u001B[1mwrote\u001B[0m \u001B[32m1.00TB\u001B[0m in \u001B[36m 0s\u001B[0m, \u001B[32m910.82TB/s\u001B[0m\r                                                                                                                            \r",
        "> ",
        "> ",
        "cat(\"\\nâœ…è½‰æ›å®Œæˆï¼CSVæª”æ¡ˆå„²å­˜ç‚ºï¼š\", csv_file, \"\\n\")",
        "\nâœ…è½‰æ›å®Œæˆï¼CSVæª”æ¡ˆå„²å­˜ç‚ºï¼š å€‹äººèª²è¡¨.csv \n",
        "> ",
        "install.packages(\"lubridate\")",
        "\n  There is a binary version available but the source version is later:\n          binary source needs_compilation\nlubridate  1.9.3  1.9.4              TRUE\n\n",
        "Do you want to install from sources the package which needs compilation? (Yes/no/cancel) ",
        "# === 7. è®€å–å‰›å‰›è½‰å¥½çš„CSVï¼Œæº–å‚™è½‰ICS ===",
        "Error in install.packages : Unrecognized response â€œ# === 7. è®€å–å‰›å‰›è½‰å¥½çš„CSVï¼Œæº–å‚™è½‰ICS ===â€\n",
        "> ",
        "df <- read_csv(csv_file)",
        "\r\u001B[1mindexing\u001B[0m \u001B[34må€‹äººèª²è¡¨.csv\u001B[0m [=============================================================================] \u001B[32m125.14MB/s\u001B[0m, eta: \u001B[36m 0s\u001B[0m\r                                                                                                                                                                 \r\u001B[1mRows: \u001B[22m\u001B[34m45\u001B[39m \u001B[1mColumns: \u001B[22m\u001B[34m8\u001B[39m\n\u001B[36mâ”€â”€\u001B[39m \u001B[1mColumn specification\u001B[22m \u001B[36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”",
        "€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\u001B[39m\n\u001B[1mDelimiter:\u001B[22m \",\"\n\u001B[31mchr\u001B[39m (5): ç¯€æ¬¡(æ™‚é–“), æ˜ŸæœŸä¸€, æ˜ŸæœŸäºŒ, æ˜ŸæœŸä¸‰, æ˜ŸæœŸå››\n\u001B[33mlgl\u001B[39m (3): æ˜ŸæœŸäº”, æ˜ŸæœŸå…­, æ˜ŸæœŸæ—¥\n\n\u001B[36mâ„¹\u001B[39m Use `spec()` to retrieve the full column specification for this data.\n\u001B[36mâ„¹\u001B[39m Specify the column types ",
        "or set `show_col_types = FALSE` to quiet this message.\n",
        "> ",
        "> ",
        "# === 8. è¨­å®šè¡Œäº‹æ›†åƒæ•¸ ===",
        "> ",
        "ics_file <- sub(\"\\\\.csv$\", \".ics\", csv_file)   # è·ŸCSVåŒåï¼Œå‰¯æª”åæ”¹æˆ.ics",
        "> ",
        "semester_start_date <- as.Date(\"2025-02-17\")   # âš¡è«‹å¡«ä½ é€™å­¸æœŸé–‹å­¸é‚£å‘¨ã€Œæ˜ŸæœŸä¸€ã€çš„æ—¥æœŸï¼",
        "> ",
        "> ",
        "# === 9. å®šç¾©ç¯€æ¬¡æ™‚é–“è¡¨ ===",
        "> ",
        "time_table <- list(",
        "+ ",
        "  \"06:10~07:00\" = c(\"06:10\", \"07:00\"),",
        "+ ",
        "  \"07:10~08:00\" = c(\"07:10\", \"08:00\"),",
        "+ ",
        "  \"08:10~09:00\" = c(\"08:10\", \"09:00\"),",
        "+ ",
        "  \"09:10~10:00\" = c(\"09:10\", \"10:00\"),",
        "+ ",
        "  \"10:10~11:00\" = c(\"10:10\", \"11:00\"),",
        "+ ",
        "  \"11:10~12:00\" = c(\"11:10\", \"12:00\"),",
        "+ ",
        "  \"12:10~13:00\" = c(\"12:10\", \"13:00\"),",
        "+ ",
        "  \"13:10~14:00\" = c(\"13:10\", \"14:00\"),",
        "+ ",
        "  \"14:10~15:00\" = c(\"14:10\", \"15:00\"),",
        "+ ",
        "  \"15:10~16:00\" = c(\"15:10\", \"16:00\"),",
        "+ ",
        "  \"16:10~17:00\" = c(\"16:10\", \"17:00\"),",
        "+ ",
        "  \"17:10~18:00\" = c(\"17:10\", \"18:00\"),",
        "+ ",
        "  \"18:10~19:00\" = c(\"18:10\", \"19:00\"),",
        "+ ",
        "  \"19:10~20:00\" = c(\"19:10\", \"20:00\"),",
        "+ ",
        "  \"20:10~21:00\" = c(\"20:10\", \"21:00\"),",
        "+ ",
        "  \"21:10~22:00\" = c(\"21:10\", \"22:00\")",
        "+ ",
        ")",
        "> ",
        "> ",
        "# === 10. å»ºç«‹.icsé–‹é ­ ===",
        "> ",
        "ics_content <- c(",
        "+ ",
        "  \"BEGIN:VCALENDAR\",",
        "+ ",
        "  \"VERSION:2.0\",",
        "+ ",
        "  \"CALSCALE:GREGORIAN\",",
        "+ ",
        "  \"METHOD:PUBLISH\"",
        "+ ",
        ")",
        "> ",
        "> ",
        "# === 11. è½‰æ›æ¯ä¸€å ‚èª²æˆäº‹ä»¶ ===",
        "> ",
        "weekdays_map <- c(\"æ˜ŸæœŸä¸€\"=1, \"æ˜ŸæœŸäºŒ\"=2, \"æ˜ŸæœŸä¸‰\"=3, \"æ˜ŸæœŸå››\"=4, \"æ˜ŸæœŸäº”\"=5, \"æ˜ŸæœŸå…­\"=6, \"æ˜ŸæœŸæ—¥\"=7)",
        "> ",
        "> ",
        "for (i in 1:nrow(df)) {",
        "+ ",
        "  period <- df$`ç¯€æ¬¡(æ™‚é–“)`[i]",
        "+ ",
        "  ",
        "+ ",
        "  if (period %in% names(time_table)) {",
        "+ ",
        "    times <- time_table[[period]]",
        "+ ",
        "    ",
        "+ ",
        "    for (day in names(weekdays_map)) {",
        "+ ",
        "      course_name <- df[[day]][i]",
        "+ ",
        "      ",
        "+ ",
        "      if (!is.na(course_name) && course_name != \"\") {",
        "+ ",
        "        # æ‰¾å‡ºé€™ä¸€å¤©çš„æ—¥æœŸ",
        "+ ",
        "        day_offset <- weekdays_map[[day]] - 1",
        "+ ",
        "        class_date <- semester_start_date + days(day_offset)",
        "+ ",
        "        ",
        "+ ",
        "        # èµ·å§‹èˆ‡çµæŸæ™‚é–“",
        "+ ",
        "        start_datetime <- as.POSIXct(paste(class_date, times[1]))",
        "+ ",
        "        end_datetime <- as.POSIXct(paste(class_date, times[2]))",
        "+ ",
        "        ",
        "+ ",
        "        # æ ¼å¼åŒ–æˆUTCæ™‚é–“ï¼ˆç¬¦åˆICSæ¨™æº–ï¼‰",
        "+ ",
        "        dtstart <- format(start_datetime, \"%Y%m%dT%H%M%S\")",
        "+ ",
        "        dtend <- format(end_datetime, \"%Y%m%dT%H%M%S\")",
        "+ ",
        "        ",
        "+ ",
        "        # åŠ å…¥äº‹ä»¶",
        "+ ",
        "        event <- c(",
        "+ ",
        "          \"BEGIN:VEVENT\",",
        "+ ",
        "          paste0(\"SUMMARY:\", course_name),",
        "+ ",
        "          paste0(\"DTSTART;TZID=Asia/Taipei:\", dtstart),",
        "+ ",
        "          paste0(\"DTEND;TZID=Asia/Taipei:\", dtend),",
        "+ ",
        "          paste0(\"DESCRIPTION:\", course_name),",
        "+ ",
        "          \"END:VEVENT\"",
        "+ ",
        "        )",
        "+ ",
        "        ",
        "+ ",
        "        ics_content <- c(ics_content, event)",
        "+ ",
        "      }",
        "+ ",
        "    }",
        "+ ",
        "  }",
        "+ ",
        "}",
        "> ",
        "> ",
        "# === 12. æ”¶å°¾.ics ===",
        "> ",
        "ics_content <- c(ics_content, \"END:VCALENDAR\")",
        "> ",
        "> ",
        "# === 13. å¯«å‡ºICSæª”æ¡ˆ ===",
        "> ",
        "writeLines(ics_content, ics_file)",
        "> ",
        "> ",
        "cat(\"\\nâœ… è½‰æ›æˆåŠŸï¼ICSè¡Œäº‹æ›†æª”å„²å­˜ç‚ºï¼š\", ics_file, \"\\n\")",
        "\nâœ… è½‰æ›æˆåŠŸï¼ICSè¡Œäº‹æ›†æª”å„²å­˜ç‚ºï¼š å€‹äººèª²è¡¨.ics \n",
        "> ",
        "# === 1. è¼‰å…¥å‰›å‰›ç”¢ç”Ÿçš„CSVæª” ===",
        "> ",
        "csv_file <- \"å€‹äººèª²è¡¨.csv\"",
        "> ",
        "ics_file <- \"å€‹äººèª²è¡¨.ics\"",
        "> ",
        "semester_start_date <- as.Date(\"2025-02-17\")  # âš¡é–‹å­¸ç¬¬ä¸€å€‹æ˜ŸæœŸä¸€çš„æ—¥æœŸï¼",
        "> ",
        "> ",
        "# è®€CSV",
        "> ",
        "df <- read_csv(csv_file)",
        "\r\u001B[1mindexing\u001B[0m \u001B[34må€‹äººèª²è¡¨.csv\u001B[0m [=============================================================================] \u001B[32m186.02MB/s\u001B[0m, eta: \u001B[36m 0s\u001B[0m\r                                                                                                                                                                 \r\u001B[1mRows: \u001B[22m\u001B[34m45\u001B[39m \u001B[1mColumns: \u001B[22m\u001B[34m8\u001B[39m\n\u001B[36mâ”€â”€\u001B[39m \u001B[1mColumn specification\u001B[22m \u001B[36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”",
        "€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\u001B[39m\n\u001B[1mDelimiter:\u001B[22m \",\"\n\u001B[31mchr\u001B[39m (5): ç¯€æ¬¡(æ™‚é–“), æ˜ŸæœŸä¸€, æ˜ŸæœŸäºŒ, æ˜ŸæœŸä¸‰, æ˜ŸæœŸå››\n\u001B[33mlgl\u001B[39m (3): æ˜ŸæœŸäº”, æ˜ŸæœŸå…­, æ˜ŸæœŸæ—¥\n\n\u001B[36mâ„¹\u001B[39m Use `spec()` to retrieve the full column specification for this data.\n\u001B[36mâ„¹\u001B[39m Specify the column types ",
        "or set `show_col_types = FALSE` to quiet this message.\n",
        "> ",
        "> ",
        "# å…ˆæª¢æŸ¥ä¸€ä¸‹è³‡æ–™ï¼ˆé‡è¦ï¼‰",
        "> ",
        "print(df)",
        "\u001B[38;5;246m# A tibble: 45 Ã— 8\u001B[39m\n   `ç¯€æ¬¡(æ™‚é–“)`    æ˜ŸæœŸä¸€        æ˜ŸæœŸäºŒ     æ˜ŸæœŸä¸‰ æ˜ŸæœŸå›› æ˜ŸæœŸäº” æ˜ŸæœŸå…­ æ˜ŸæœŸæ—¥\n   \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m           \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m      \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m  \u001B[3m\u001B[38;5;246m<lgl>\u001B[39m\u001B[23m  \u001B[3m\u001B[38;5;246m<lgl>\u001B[39m\u001B[23m  \u001B[3m\u001B[38;5;246m<lgl>\u001B[39m\u001B[23m \n\u001B[38;5;250m 1\u001B[39m 1               \u001B[31mNA\u001B[39m            \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m ",
        "    \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 2\u001B[39m (06:10~07:00)   \u001B[31mNA\u001B[39m            \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 3\u001B[39m é«”è‚²(äºŒ)AY      \u001B[31mNA\u001B[39m            \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 4\u001B[39m 2               Då€é«”è‚²é¤¨ä¸»å ´ \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m  ",
        "   \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 5\u001B[39m (07:10~08:00)   é«”è‚²(äºŒ)AY    \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 6\u001B[39m Då€æ¡Œçƒå®¤       \u001B[31mNA\u001B[39m            \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 7\u001B[39m æœå‹™å­¸ç¿’(ä¸€)_è³‡ é«”è‚²(äºŒ)AY    \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B",
        "[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 8\u001B[39m 3               ç®¡ç³»          Då€æ¡Œçƒå®¤  \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 9\u001B[39m (08:10~09:00)   ç®¡ç†å­¸é™¢B119  é«”è‚²(äºŒ)AY \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m10\u001B[39m Då€é«”è‚²é¤¨ä¸»å ´   \u001B[31mNA\u001B[39m            \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;",
        "5;246m# â„¹ 35 more rows\u001B[39m\n\u001B[38;5;246m# â„¹ Use `print(n = ...)` to see more rows\u001B[39m\n",
        "> ",
        "> ",
        "# === 2. ç¯€æ¬¡æ™‚é–“è¡¨ ===",
        "> ",
        "time_table <- list(",
        "+ ",
        "  \"06:10~07:00\" = c(\"06:10\", \"07:00\"),",
        "+ ",
        "  \"07:10~08:00\" = c(\"07:10\", \"08:00\"),",
        "+ ",
        "  \"08:10~09:00\" = c(\"08:10\", \"09:00\"),",
        "+ ",
        "  \"09:10~10:00\" = c(\"09:10\", \"10:00\"),",
        "+ ",
        "  \"10:10~11:00\" = c(\"10:10\", \"11:00\"),",
        "+ ",
        "  \"11:10~12:00\" = c(\"11:10\", \"12:00\"),",
        "+ ",
        "  \"12:10~13:00\" = c(\"12:10\", \"13:00\"),",
        "+ ",
        "  \"13:10~14:00\" = c(\"13:10\", \"14:00\"),",
        "+ ",
        "  \"14:10~15:00\" = c(\"14:10\", \"15:00\"),",
        "+ ",
        "  \"15:10~16:00\" = c(\"15:10\", \"16:00\"),",
        "+ ",
        "  \"16:10~17:00\" = c(\"16:10\", \"17:00\"),",
        "+ ",
        "  \"17:10~18:00\" = c(\"17:10\", \"18:00\"),",
        "+ ",
        "  \"18:10~19:00\" = c(\"18:10\", \"19:00\"),",
        "+ ",
        "  \"19:10~20:00\" = c(\"19:10\", \"20:00\"),",
        "+ ",
        "  \"20:10~21:00\" = c(\"20:10\", \"21:00\"),",
        "+ ",
        "  \"21:10~22:00\" = c(\"21:10\", \"22:00\")",
        "+ ",
        ")",
        "> ",
        "> ",
        "# === 3. æ˜ŸæœŸå°æ‡‰è¡¨ ===",
        "> ",
        "weekdays_map <- c(\"æ˜ŸæœŸä¸€\"=1, \"æ˜ŸæœŸäºŒ\"=2, \"æ˜ŸæœŸä¸‰\"=3, \"æ˜ŸæœŸå››\"=4, \"æ˜ŸæœŸäº”\"=5, \"æ˜ŸæœŸå…­\"=6, \"æ˜ŸæœŸæ—¥\"=7)",
        "> ",
        "> ",
        "# === 4. é–‹å§‹å»ºç«‹ICSå…§å®¹ ===",
        "> ",
        "ics_content <- c(",
        "+ ",
        "  \"BEGIN:VCALENDAR\",",
        "+ ",
        "  \"VERSION:2.0\",",
        "+ ",
        "  \"CALSCALE:GREGORIAN\",",
        "+ ",
        "  \"METHOD:PUBLISH\"",
        "+ ",
        ")",
        "> ",
        "> ",
        "for (i in 1:nrow(df)) {",
        "+ ",
        "  period <- df$`ç¯€æ¬¡(æ™‚é–“)`[i]",
        "+ ",
        "  ",
        "+ ",
        "  if (period %in% names(time_table)) {",
        "+ ",
        "    times <- time_table[[period]]",
        "+ ",
        "    ",
        "+ ",
        "    for (day in names(weekdays_map)) {",
        "+ ",
        "      course_name <- df[[day]][i]",
        "+ ",
        "      ",
        "+ ",
        "      if (!is.na(course_name) && trimws(course_name) != \"\") {",
        "+ ",
        "        # è¨ˆç®—è©²å ‚èª²çš„æ—¥æœŸ",
        "+ ",
        "        day_offset <- weekdays_map[[day]] - 1",
        "+ ",
        "        class_date <- semester_start_date + days(day_offset)",
        "+ ",
        "        ",
        "+ ",
        "        # èµ·å§‹èˆ‡çµæŸæ™‚é–“",
        "+ ",
        "        start_datetime <- as.POSIXct(paste(class_date, times[1]))",
        "+ ",
        "        end_datetime <- as.POSIXct(paste(class_date, times[2]))",
        "+ ",
        "        ",
        "+ ",
        "        # æ ¼å¼è½‰æˆICSç”¨çš„æ™‚é–“æ ¼å¼",
        "+ ",
        "        dtstart <- format(start_datetime, \"%Y%m%dT%H%M%S\")",
        "+ ",
        "        dtend <- format(end_datetime, \"%Y%m%dT%H%M%S\")",
        "+ ",
        "        ",
        "+ ",
        "        # å»ºç«‹å–®ä¸€å ‚èª²çš„VEVENT",
        "+ ",
        "        event <- c(",
        "+ ",
        "          \"BEGIN:VEVENT\",",
        "+ ",
        "          paste0(\"SUMMARY:\", course_name),",
        "+ ",
        "          paste0(\"DTSTART;TZID=Asia/Taipei:\", dtstart),",
        "+ ",
        "          paste0(\"DTEND;TZID=Asia/Taipei:\", dtend),",
        "+ ",
        "          paste0(\"DESCRIPTION:\", course_name),",
        "+ ",
        "          \"END:VEVENT\"",
        "+ ",
        "        )",
        "+ ",
        "        ",
        "+ ",
        "        ics_content <- c(ics_content, event)",
        "+ ",
        "      }",
        "+ ",
        "    }",
        "+ ",
        "  }",
        "+ ",
        "}",
        "> ",
        "> ",
        "# === 5. çµå°¾ ===",
        "> ",
        "ics_content <- c(ics_content, \"END:VCALENDAR\")",
        "> ",
        "> ",
        "# === 6. å¯«å‡ºICSæª”æ¡ˆ ===",
        "> ",
        "writeLines(ics_content, ics_file)",
        "> ",
        "> ",
        "cat(\"\\nâœ… è½‰æ›å®Œæˆï¼æ–°çš„ICSå·²å„²å­˜ï¼š\", ics_file, \"\\n\")",
        "\nâœ… è½‰æ›å®Œæˆï¼æ–°çš„ICSå·²å„²å­˜ï¼š å€‹äººèª²è¡¨.ics \n",
        "> ",
        "print(df)",
        "\u001B[38;5;246m# A tibble: 45 Ã— 8\u001B[39m\n   `ç¯€æ¬¡(æ™‚é–“)`    æ˜ŸæœŸä¸€        æ˜ŸæœŸäºŒ     æ˜ŸæœŸä¸‰ æ˜ŸæœŸå›› æ˜ŸæœŸäº” æ˜ŸæœŸå…­ æ˜ŸæœŸæ—¥\n   \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m           \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m      \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m  \u001B[3m\u001B[38;5;246m<lgl>\u001B[39m\u001B[23m  \u001B[3m\u001B[38;5;246m<lgl>\u001B[39m\u001B[23m  \u001B[3m\u001B[38;5;246m<lgl>\u001B[39m\u001B[23m \n\u001B[38;5;250m 1\u001B[39m 1               \u001B[31mNA\u001B[39m            \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m ",
        "    \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 2\u001B[39m (06:10~07:00)   \u001B[31mNA\u001B[39m            \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 3\u001B[39m é«”è‚²(äºŒ)AY      \u001B[31mNA\u001B[39m            \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 4\u001B[39m 2               Då€é«”è‚²é¤¨ä¸»å ´ \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m  ",
        "   \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 5\u001B[39m (07:10~08:00)   é«”è‚²(äºŒ)AY    \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 6\u001B[39m Då€æ¡Œçƒå®¤       \u001B[31mNA\u001B[39m            \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 7\u001B[39m æœå‹™å­¸ç¿’(ä¸€)_è³‡ é«”è‚²(äºŒ)AY    \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B",
        "[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 8\u001B[39m 3               ç®¡ç³»          Då€æ¡Œçƒå®¤  \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m 9\u001B[39m (08:10~09:00)   ç®¡ç†å­¸é™¢B119  é«”è‚²(äºŒ)AY \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;5;250m10\u001B[39m Då€é«”è‚²é¤¨ä¸»å ´   \u001B[31mNA\u001B[39m            \u001B[31mNA\u001B[39m         \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m     \u001B[31mNA\u001B[39m    \n\u001B[38;",
        "5;246m# â„¹ 35 more rows\u001B[39m\n\u001B[38;5;246m# â„¹ Use `print(n = ...)` to see more rows\u001B[39m\n",
        "> ",
        "> ",
        "install.packages(c(\"pdftools\", \"readr\", \"stringr\"))",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "> ",
        "library(pdftools)",
        "> ",
        "library(readr)",
        "> ",
        "library(stringr)",
        "\nRestarting R session...\n\n"
    ]
}